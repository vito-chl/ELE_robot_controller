#ifndef _MOTOR_H
#define _MOTOR_H

#include"rtthread.h"
#include"rtdevice.h"
#include"common.h"

#define SPEED_MODE 		0
#define DISTANCE_MODE 	1
#define UNSET_MODE 		2

#define SET_OPTMODE_CMD {0x00, 0x06, 0x00, 0x24, 0x00, 0x00, 0x00, 0x00}

#define SET_CTRMODE_POS_CMD {0x00, 0x06, 0x00, 0x25, 0x00, 0x02, 0x00, 0x00}
#define SET_CTRMODE_SPEED_CMD {0x00, 0x06, 0x00, 0x25, 0x00, 0x01, 0x00, 0x00}

#define SET_MOVMODE_ABSOLUTE_CMD {0x00, 0x06, 0x00, 0x2D, 0x00, 0x00, 0x00, 0x00}	
#define SET_MOVMODE_RELATIVE_CMD {0x00, 0x06, 0x00, 0x2D, 0x00, 0x01, 0x00, 0x00}	

#define ENABLD_MOTOR_CMD {0x00, 0x06, 0x00, 0x28, 0x00, 0x01, 0x00, 0x00}
#define DISABLD_MOTOR_CMD {0x00, 0x06, 0x00, 0x28, 0x00, 0x00, 0x00, 0x00}

#define SET_MOVE_DISTANCE_CMD {0x00, 0x10, 0x00, 0x26, 0x00, 0x02, 0x04, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00}
#define SET_MOVE_SPEED_CMD {0x00, 0x06, 0x00, 0xAE, 0xFF, 0xFF, 0x00, 0x00}
#define START_MOVE_CMD {0x00, 0x06, 0x00, 0x29, 0x00, 0x01, 0x00, 0x00}

#define READ_SET_DISTANCE_VALUE_CMD {0x00, 0x03, 0x00, 0xAA, 0x00, 0x02, 0x00, 0x00}
#define READ_CUR_DISTANCE_VALUE_CMD {0x00, 0x03, 0x00, 0xAC, 0x00, 0x02, 0x00, 0x00}
#define READ_CUR_SPEED_VALUE_CMD {0x00, 0x03, 0x00, 0xAF, 0x00, 0x01, 0x00, 0x00}


/* 电机设置, 不接受返回值 */
int ctrl_motor_noret(uint8_t motor_id, uint8_t* cmd, uint8_t len);

/* 电机设置, 接受返回值 u16 */
// crc 正确返回1 不正确返回0
int ctrl_motor_ret(uint8_t motor_id, uint8_t* cmd, uint8_t len, uint8_t* retptr, uint8_t* retlen);

void set_speed(uint8_t motorid, int16_t speed);
void set_distance(uint8_t motorid, int32_t distance);

void motor_init(uint8_t motorid);

void motor_set_mode(uint8_t motorid, int mode);

/* 速度读取函数，返回值为速度 */
int16_t read_speed(uint8_t motorid);
int32_t read_set_pos(uint8_t motorid);
int32_t read_cur_pos(uint8_t motorid);



#endif
